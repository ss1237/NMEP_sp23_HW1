=> merge config from configs/alexnet_base.yaml
[32m[2023-03-16 09:22:45 alexnet_test][33m(main.py 247)[39m: INFO Full config saved to output/alexnet/config.yaml
[32m[2023-03-16 09:22:45 alexnet_test][33m(main.py 253)[39m: INFO AUG:
  COLOR_JITTER: 0.4
  RAND_AUGMENT: rand-m9-mstd0.5-inc1
BASE:
- ''
DATA:
  BATCH_SIZE: 1024
  DATASET: cifar10
  DATA_PATH: ''
  IMG_SIZE: 70
  INTERPOLATION: bicubic
  NUM_WORKERS: 32
  PIN_MEMORY: true
EVAL_MODE: false
MODEL:
  DROP_RATE: 0.0
  NAME: alexnet
  NUM_CLASSES: 200
  RESNET: {}
  RESUME: ''
OUTPUT: output/alexnet
PRINT_FREQ: 99999
SAVE_FREQ: 5
SEED: 0
TEST:
  CROP: true
  SEQUENTIAL: false
  SHUFFLE: false
TRAIN:
  ACCUMULATION_STEPS: 1
  EPOCHS: 50
  LR: 0.0003
  LR_SCHEDULER:
    NAME: cosine
  MIN_LR: 3.0e-05
  OPTIMIZER:
    BETAS:
    - 0.9
    - 0.999
    EPS: 1.0e-08
    MOMENTUM: 0.9
    NAME: adamw
  START_EPOCH: 0
  WARMUP_EPOCHS: 10
  WARMUP_LR: 3.0e-05
[32m[2023-03-16 09:22:45 alexnet_test][33m(main.py 254)[39m: INFO {"cfg": "configs/alexnet_base.yaml", "opts": null, "batch_size": null, "data_path": null, "resume": null, "output": "output", "eval": false, "throughput": false}
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
[32m[2023-03-16 09:22:52 alexnet_test][33m(main.py 73)[39m: INFO AlexNet(
  #params: 57.82M, #flops: 95.59M
  (features): Sequential(
    #params: 2.47M, #flops: 40.24M
    (0): Conv2d(
      3, 64, kernel_size=(11, 11), stride=(4, 4), padding=(2, 2)
      #params: 23.3K, #flops: 5.95M
    )
    (1): ReLU()
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
    (3): Conv2d(
      64, 192, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2)
      #params: 0.31M, #flops: 15.05M
    )
    (4): ReLU()
    (5): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
    (6): Conv2d(
      192, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)
      #params: 0.66M, #flops: 5.97M
    )
    (7): ReLU()
    (8): Conv2d(
      384, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)
      #params: 0.88M, #flops: 7.96M
    )
    (9): ReLU()
    (10): Conv2d(
      256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)
      #params: 0.59M, #flops: 5.31M
    )
    (11): ReLU()
    (12): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
    (13): AdaptiveAvgPool2d(
      output_size=(6, 6)
      #params: 0, #flops: 0.26K
    )
  )
  (classifier): Sequential(
    #params: 55.35M, #flops: 55.35M
    (0): Dropout(p=0.5, inplace=False)
    (1): Linear(
      in_features=9216, out_features=4096, bias=True
      #params: 37.75M, #flops: 37.75M
    )
    (2): ReLU()
    (3): Dropout(p=0.5, inplace=False)
    (4): Linear(
      in_features=4096, out_features=4096, bias=True
      #params: 16.78M, #flops: 16.78M
    )
    (5): ReLU()
    (6): Linear(
      in_features=4096, out_features=200, bias=True
      #params: 0.82M, #flops: 0.82M
    )
  )
)
[32m[2023-03-16 09:22:52 alexnet_test][33m(main.py 74)[39m: INFO number of params: 57.82324 M
[32m[2023-03-16 09:22:52 alexnet_test][33m(main.py 75)[39m: INFO flops: 95.588608 MFLOPS
[32m[2023-03-16 09:22:52 alexnet_test][33m(main.py 91)[39m: INFO Start training
Unsupported operator aten::max_pool2d encountered 3 time(s)



 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████       | 46/49 [00:09<00:00, 11.78it/s]
[32m[2023-03-16 09:23:02 alexnet_test][33m(main.py 162)[39m: INFO Train: [0/50]	lr 0.000300	time 0.0729 (0.1970)	loss 2.3182 (2.9817)	Acc@1 9.198 (9.686)	Mem 2207MB
[32m[2023-03-16 09:23:02 alexnet_test][33m(main.py 171)[39m: INFO EPOCH 0 training takes 0:00:09
[32m[2023-03-16 09:23:02 alexnet_test][33m(main.py 95)[39m: INFO  * Train Acc 9.686 Train Loss 2.982

[32m[2023-03-16 09:23:02 alexnet_test][33m(main.py 96)[39m: INFO Accuracy of the network on the 50000 train images: 9.7%
[32m[2023-03-16 09:23:05 alexnet_test][33m(main.py 207)[39m: INFO Validate: 	Time 0.050 (0.270)	Loss 2.3173 (2.3172)	Acc@1 8.673 (10.000)	Mem 2207MB
[32m[2023-03-16 09:23:05 alexnet_test][33m(main.py 100)[39m: INFO  * Val Acc 10.000 Val Loss 2.317
[32m[2023-03-16 09:23:05 alexnet_test][33m(main.py 101)[39m: INFO Accuracy of the network on the 10000 val images: 10.0%
[32m[2023-03-16 09:23:05 alexnet_test][33m(load_save.py 48)[39m: INFO output/alexnet/ckpt_best.pth saving......
  0%|                                                                                                                           | 0/10 [00:00<?, ?it/s]
[32m[2023-03-16 09:23:09 alexnet_test][33m(load_save.py 50)[39m: INFO output/alexnet/ckpt_best.pth saved !!!
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  3.28it/s]
  0%|                                                                                                                           | 0/49 [00:00<?, ?it/s]




 86%|█████████████████████████████████████████████████████████████████████████████████████████████████▋                | 42/49 [00:08<00:00, 11.67it/s]
[32m[2023-03-16 09:23:21 alexnet_test][33m(main.py 162)[39m: INFO Train: [1/50]	lr 0.000300	time 0.0733 (0.1786)	loss 2.1974 (2.2947)	Acc@1 15.212 (10.860)	Mem 2207MB
[32m[2023-03-16 09:23:21 alexnet_test][33m(main.py 171)[39m: INFO EPOCH 1 training takes 0:00:08
[32m[2023-03-16 09:23:21 alexnet_test][33m(main.py 95)[39m: INFO  * Train Acc 10.860 Train Loss 2.295
[32m[2023-03-16 09:23:21 alexnet_test][33m(main.py 96)[39m: INFO Accuracy of the network on the 50000 train images: 10.9%
[32m[2023-03-16 09:23:24 alexnet_test][33m(main.py 207)[39m: INFO Validate: 	Time 0.055 (0.309)	Loss 2.1491 (2.1543)	Acc@1 17.219 (17.230)	Mem 2207MB
[32m[2023-03-16 09:23:24 alexnet_test][33m(main.py 100)[39m: INFO  * Val Acc 17.230 Val Loss 2.154
[32m[2023-03-16 09:23:24 alexnet_test][33m(main.py 101)[39m: INFO Accuracy of the network on the 10000 val images: 17.2%
[32m[2023-03-16 09:23:24 alexnet_test][33m(main.py 112)[39m: INFO Max accuracy: 17.23%



 61%|█████████████████████████████████████████████████████████████████████▊                                            | 30/49 [00:05<00:01, 11.34it/s]
[32m[2023-03-16 09:23:32 alexnet_test][33m(main.py 162)[39m: INFO Train: [2/50]	lr 0.000299	time 0.0737 (0.1551)	loss 1.8493 (1.9903)	Acc@1 24.175 (20.416)	Mem 2207MB
[32m[2023-03-16 09:23:32 alexnet_test][33m(main.py 171)[39m: INFO EPOCH 2 training takes 0:00:07
[32m[2023-03-16 09:23:32 alexnet_test][33m(main.py 95)[39m: INFO  * Train Acc 20.416 Train Loss 1.990
[32m[2023-03-16 09:23:32 alexnet_test][33m(main.py 96)[39m: INFO Accuracy of the network on the 50000 train images: 20.4%
  0%|                                                                                                                           | 0/49 [00:00<?, ?it/s]
[32m[2023-03-16 09:23:35 alexnet_test][33m(main.py 207)[39m: INFO Validate: 	Time 0.048 (0.279)	Loss 1.8456 (1.8557)	Acc@1 23.980 (24.150)	Mem 2207MB
[32m[2023-03-16 09:23:35 alexnet_test][33m(main.py 100)[39m: INFO  * Val Acc 24.150 Val Loss 1.856
[32m[2023-03-16 09:23:35 alexnet_test][33m(main.py 101)[39m: INFO Accuracy of the network on the 10000 val images: 24.1%



 78%|████████████████████████████████████████████████████████████████████████████████████████▍                         | 38/49 [00:07<00:00, 11.50it/s]
[32m[2023-03-16 09:23:43 alexnet_test][33m(main.py 162)[39m: INFO Train: [3/50]	lr 0.000297	time 0.0750 (0.1661)	loss 1.6956 (1.8180)	Acc@1 35.377 (27.554)	Mem 2207MB
[32m[2023-03-16 09:23:43 alexnet_test][33m(main.py 171)[39m: INFO EPOCH 3 training takes 0:00:08
[32m[2023-03-16 09:23:43 alexnet_test][33m(main.py 95)[39m: INFO  * Train Acc 27.554 Train Loss 1.818
[32m[2023-03-16 09:23:43 alexnet_test][33m(main.py 96)[39m: INFO Accuracy of the network on the 50000 train images: 27.6%
[32m[2023-03-16 09:23:46 alexnet_test][33m(main.py 207)[39m: INFO Validate: 	Time 0.063 (0.298)	Loss 1.6861 (1.6924)	Acc@1 35.714 (35.220)	Mem 2207MB
[32m[2023-03-16 09:23:46 alexnet_test][33m(main.py 100)[39m: INFO  * Val Acc 35.220 Val Loss 1.692
[32m[2023-03-16 09:23:46 alexnet_test][33m(main.py 101)[39m: INFO Accuracy of the network on the 10000 val images: 35.2%
[32m[2023-03-16 09:23:46 alexnet_test][33m(main.py 112)[39m: INFO Max accuracy: 35.22%



 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 48/49 [00:07<00:00, 11.51it/s]
[32m[2023-03-16 09:23:54 alexnet_test][33m(main.py 162)[39m: INFO Train: [4/50]	lr 0.000295	time 0.0745 (0.1570)	loss 1.5953 (1.6465)	Acc@1 38.443 (36.010)	Mem 2207MB
[32m[2023-03-16 09:23:54 alexnet_test][33m(main.py 171)[39m: INFO EPOCH 4 training takes 0:00:07
[32m[2023-03-16 09:23:54 alexnet_test][33m(main.py 95)[39m: INFO  * Train Acc 36.010 Train Loss 1.647

[32m[2023-03-16 09:23:54 alexnet_test][33m(main.py 96)[39m: INFO Accuracy of the network on the 50000 train images: 36.0%
  0%|                                                                                                                           | 0/49 [00:00<?, ?it/s]
[32m[2023-03-16 09:23:57 alexnet_test][33m(main.py 207)[39m: INFO Validate: 	Time 0.051 (0.293)	Loss 1.5131 (1.4865)	Acc@1 42.092 (43.420)	Mem 2207MB
[32m[2023-03-16 09:23:57 alexnet_test][33m(main.py 100)[39m: INFO  * Val Acc 43.420 Val Loss 1.486
[32m[2023-03-16 09:23:57 alexnet_test][33m(main.py 101)[39m: INFO Accuracy of the network on the 10000 val images: 43.4%

Traceback (most recent call last):
  File "/home/sselvan/NMEP/sp23-nmep-hw1/main.py", line 256, in <module>
    main(config)
  File "/home/sselvan/NMEP/sp23-nmep-hw1/main.py", line 94, in main
    train_acc1, train_loss = train_one_epoch(config, model, criterion, data_loader_train, optimizer, epoch)
  File "/home/sselvan/NMEP/sp23-nmep-hw1/main.py", line 155, in train_one_epoch
    loss_meter.update(loss.item(), targets.size(0))
KeyboardInterrupt